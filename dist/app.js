"use strict";var _createClass=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var cloneArray=function(t){return t.map(function(t){return t.slice()})},flattenArray=function(t){return[].concat.apply([],t)},utils={cloneArray:cloneArray,flattenArray:flattenArray},Game=function(){function e(t){_classCallCheck(this,e),this.prevState=[],this.currentState=t,this.getNeighbours=this.getNeighbours.bind(this),this.calculateNext=this.calculateNext.bind(this),this.setCell=this.setCell.bind(this)}return _createClass(e,[{key:"getNeighbours",value:function(t,e){var r=this.prevState[t]||[],n=this.prevState[t-1]||[],a=this.prevState[t+1]||[],i=[[n[e-1],n[e],n[e+1]],[r[e-1],0,r[e+1]],[a[e-1],a[e],a[e+1]]];return utils.flattenArray(i).reduce(function(t,e){return t+ +!!e},0)}},{key:"calculateNext",value:function(){for(var t=[],e=0;e<this.prevState.length;++e){t[e]=[];for(var r=0;r<this.prevState[e].length;++r){var n=this.getNeighbours(e,r);3===n&&0===this.prevState[e][r]?t[e][r]=1:t[e][r]=n<2||3<n?0:this.prevState[e][r]}}return t}},{key:"next",value:function(){this.prevState=utils.cloneArray(this.currentState),this.currentState=this.calculateNext()}},{key:"print",value:function(){console.log(this.currentState)}},{key:"setCell",value:function(t,e,r){this.currentState[t][e]=+r}},{key:"getBoard",value:function(){return this.currentState}}]),e}(),View=function(){function t(){_classCallCheck(this,t),this.board=[],this.size=8}return _createClass(t,[{key:"init",value:function(){for(var t=document.querySelector("#content"),e=0;e<this.size;++e){this.board[e]=[];for(var r=document.createElement("tr"),n=new DocumentFragment,a=0;a<this.size;++a){this.board[e][a]=0;var i=document.createElement("input");i.setAttribute("type","checkbox"),i.setAttribute("data-row",e),i.setAttribute("data-col",a),n.appendChild(i)}r.appendChild(n),t.appendChild(r)}}},{key:"getBoard",value:function(){return this.board}},{key:"setBoard",value:function(n,a){for(var t=function(r){for(var t=function(e){a.find(function(t){return t.dataset.row==r&&t.dataset.col==e}).checked=!!n[r][e]},e=0;e<n[r].length;++e)t(e)},e=0;e<n.length;++e)t(e)}}]),t}(),boardView=new View;boardView.init();var gameBoard=boardView.getBoard(),currentGame=new Game(gameBoard),checkboxes=[].slice.call(document.querySelectorAll("input[type=checkbox]")),nextButton=document.querySelector("#next"),onCheckboxChange=function(t){var e=t.target.dataset.row,r=t.target.dataset.col;currentGame.setCell(e,r,!!t.target.checked)},onNext=function(t){currentGame.next();var e=currentGame.getBoard();boardView.setBoard(e,checkboxes)};checkboxes.forEach(function(t){return t.addEventListener("change",onCheckboxChange)}),nextButton.addEventListener("click",onNext);